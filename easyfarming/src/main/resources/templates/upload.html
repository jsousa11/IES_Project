<!DOCTYPE html>
<html lang="eng" xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Easy Farming</title>
        <link href= "css/style.css" rel="stylesheet"/>
        <link href='https://fonts.googleapis.com/css?family=ABeeZee' rel='stylesheet'>
        <meta nome="viewport" content=" witdth= device-width, initial-scale=1.0, maximum-scale=1.0">
    </head>
    <body>
        <header>
            <div class = "center">
                <div class="logo"><img class= "image" src="assets/Logotipo planta com folhas.png" height="150" width="150"></div><!--logo-->
                <div class="menu">
                    <a href="/index.html" th:href="@{/home}">Home</a>
                    <a href="/about.html" th:href="@{/about}">About Us</a>
                    <a href="/login.html" th:href="@{/login}">Login</a>
                </div><!--menu-->
            </div><!--center-->
        </header>
        <div class="center">
            <h1 class="h1-upload">Upload the image of your plant and find out everything about it!</h1>
            <form onsubmit="return onSubmit(event)" method="post">
              <label for="img">Select image:</label>
              <input type="file" id="img" name="img" accept="image/*">
              <button type="submit">Submit</button>
            </form>
            <div class="space"></div>
            <p class="p-results">Results</p>
            <ul id="resultados"></ul>
            <script>
                function onSubmit(ev) {
                    ev.preventDefault();
                    console.log("Ei")
                    var input = document.querySelector('input[type="file"]')

                    var data = new FormData()
                    data.append('image', input.files[0]);

                    fetch('https://plantrecog.up.railway.app/predict', {
                        method: 'POST',
                        body: data
                    }).then(async resp => {
                        json = await resp.json();
                        res = document.getElementById("resultados");
                        json["payload"]["predictions"].map(el => el["name"]).forEach(name => {
                            child = document.createElement("li");
                            child.innerHTML = `<a class="a-results" href="info/${name.toLowerCase()}">${name}</a>`;
                            res.appendChild(child);
                        });
                    })

                    return false;
                }
            </script>
        </div>
        <div class="extras-upload">
            <img src="assets/—Pngtree—character collection of gardener big_7585259.png"height="800" width="800"/>
        </div><!--extras-->
    </body>
</html>